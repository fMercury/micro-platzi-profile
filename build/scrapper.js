'use strict';Object.defineProperty(exports,'__esModule',{value:true});/**
 * Get user info from the user Profile
 * @param  {string} username The user to scrap
 * @return {Object}          The scrapped data
 */var scrapper=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(username){var url,response,html,window,document,name,description,socialNetworks,link,avatar,points,courses;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url='https://platzi.com/@'+username;_context.next=3;return fetch(url);case 3:response=_context.sent;_context.next=6;return response.text();case 6:html=_context.sent;_context.next=9;return jsdomPromised(html);case 9:window=_context.sent;document=window.document;name=document.querySelector('.ProfileHeader-name').innerHTML;description=document.querySelector('.ProfileHeader-description').innerHTML;socialNetworks=Array.from(document.querySelectorAll('.ProfileHeader-socialBtn')).map(function($socialBtn){var link=$socialBtn.getAttribute('href');var type=link.indexOf('facebook')>-1?'facebook':'twitter';return{type:type,link:link}});link=document.querySelector('.ProfileHeader-link').getAttribute('href');avatar=document.querySelector('.ProfileHeader-avatar > img').getAttribute('src');points=Array.from(document.querySelectorAll('.ProfileHeader-points')).map(function($point){var amount=$point.querySelector('.ProfileHeader-number').innerHTML;var type=$point.querySelector('.ProfileHeader-type').innerHTML;return{amount:amount,type:type}});courses=Array.from(document.querySelectorAll('.Course')).map(function($course){var title=$course.querySelector('.Course-title').childNodes[1].data;var career=$course.querySelector('.Course-career').innerHTML;var percentage=$course.querySelector('.Course-percentage').childNodes[1].data;var badgeUrl=$course.querySelector('.Course-badge > img').getAttribute('src');return{title:title,career:career,percentage:percentage,badgeUrl:badgeUrl}});return _context.abrupt('return',{url:url,user:{username:username,name:name,description:description,socialNetworks:socialNetworks,link:link,avatar:avatar,points:points},courses:courses});case 19:case'end':return _context.stop();}}},_callee,this)}));return function scrapper(_x){return _ref.apply(this,arguments)}}();var _jsdom=require('jsdom');require('isomorphic-fetch');function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){return step('next',value)},function(err){return step('throw',err)})}}return step('next')})}}/**
 * Promise wrapper for jsdom
 * @param  {string} html The HTML string to use for the DOM
 * @return {Object}      The `window` object
 */function jsdomPromised(html){return new Promise(function(resolve,reject){(0,_jsdom.env)(html,[],function(error,window){if(error)return reject(error);return resolve(window)})})}exports.default=scrapper;